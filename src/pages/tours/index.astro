---
import BaseLayout from '../../layouts/BaseLayout.astro';
import TourCard from '../../components/TourCard.astro';

// All tours with real content
const allTours = [
  {
    title: '4x4 Full Day Island Tour',
    description: 'Explore Santa Monica beach, discover shipwrecks, see Varandinha\'s mysterious caves, sandboard on dunes, and savor a tasty local lunch.',
    image: '/images/tours/island-tour.jpg',
    duration: '6 hours',
    price: '€70 / €50',
    slug: 'island-tour',
    category: 'Full Day'
  },
  {
    title: 'Whale Watching Expedition',
    description: 'Join us on the ultimate whale-watching expedition in the pristine waters of Boa Vista Island. Seasonal tour from March to May.',
    image: '/images/tours/whale-watching.jpg',
    duration: '3 hours',
    price: '€80 / €60',
    slug: 'whale-watching',
    category: 'Wildlife'
  },
  {
    title: '4x4 HD Turtle, Shark, Santa Monica, Sandboarding & Local Taste',
    description: 'Experience sandboarding, visit Santa Monica, see green turtles and lemon sharks in their natural habitat, and taste local specialties.',
    image: '/images/tours/green-turtle.jpg',
    duration: '4 hours',
    price: '€45 / €30',
    slug: 'green-turtle-tour',
    category: 'Wildlife',
    topPicked: true
  },
  {
    title: '4WD Buggy Adventure',
    description: 'Explore this amazing environment surrounded by untouched nature. Drive through sand dunes, desert and visit Fatima\'s Chapel and Sal Rei city.',
    image: '/images/tours/buggy-tour.jpg',
    duration: '2 hours',
    price: 'From €70',
    slug: 'buggy-adventure',
    category: 'Adventure'
  },
  {
    title: 'Off-Road Quad Bike Tour',
    description: 'Discover the diverse scenery of Cape Verde on a quad tour through sand dunes, beaches, and caves to Santa Monica beach.',
    image: '/images/tours/quad-tour.jpg',
    duration: '4 hours',
    price: '€150 / €220',
    slug: 'quad-tour',
    category: 'Adventure'
  },
  {
    title: '4x4 HD North - The Different Side',
    description: 'Visit the pottery school in Rabil, the famous shipwreck at Cabo Santa María, Fatima\'s Chapel, and enjoy snacks at Sodade Restaurant.',
    image: '/images/tours/north-tour.jpg',
    duration: '4 hours',
    price: '€50 / €40',
    slug: 'north-tour',
    category: 'Half Day'
  },
  {
    title: '4x4 HD South - The Big Surprise',
    description: 'Explore the Viana desert, the old village Povoação Velha, Varandinha\'s caves, Santa Monica beach and enjoy a cocktail at Origens.',
    image: '/images/tours/south-tour.jpg',
    duration: '4 hours',
    price: '€40 / €30',
    slug: 'south-tour',
    category: 'Half Day'
  },
  {
    title: 'Traditional & Cultural Tour',
    description: 'Visit Santos Farm, João Galego village, the lighthouse of Morro Negro, Grand Canyon and experience the charm of Route 66.',
    image: '/images/tours/traditional-tour.jpg',
    duration: '4 hours',
    price: '€45 / €30',
    slug: 'traditional-tour',
    category: 'Culture'
  },
  {
    title: 'Sandboarding Experience',
    description: 'Experience the thrill of sandboarding down the golden dunes at Morro de Areia. Professional instructor and all equipment included.',
    image: '/images/tours/sandboarding.jpg',
    duration: '2 hours',
    price: '€35 / €25',
    slug: 'sandboarding',
    category: 'Adventure'
  },
  {
    title: 'Turtle Watching Expedition',
    description: 'Witness loggerhead turtles preparing nests and laying eggs on the beach. A unique experience during nesting season (June-October).',
    image: '/images/tours/turtle-watching.jpg',
    duration: '3 hours',
    price: '€65 / €45',
    slug: 'turtle-watching',
    category: 'Wildlife'
  }
];

const categories = ['All', 'Full Day', 'Half Day', 'Adventure', 'Wildlife', 'Culture'];
---

<BaseLayout title="Tours & Expeditions" description="Explore all our tours and expeditions in Boa Vista, Cape Verde. Island tours, whale watching, quad biking, cultural experiences and more.">
  <!-- Page Header -->
  <section class="pt-24 pb-12 md:pt-32 md:pb-16 bg-primary">
    <div class="container">
      <div class="max-w-3xl">
        <span class="text-white/80 font-semibold text-sm tracking-wider uppercase">Explore Boa Vista</span>
        <h1 class="font-display font-bold text-4xl md:text-5xl text-white mt-2 mb-4">
          Tours & Expeditions
        </h1>
        <p class="text-white/90 text-lg">
          Explore our island adventures - from desert safaris to wildlife encounters.
        </p>
      </div>
    </div>
  </section>

  <!-- Filter Tabs -->
  <section class="sticky top-16 md:top-20 bg-white shadow-sm z-40">
    <div class="container">
      <div class="flex items-center justify-between py-4">
        <!-- Category filters -->
        <div class="flex gap-2 overflow-x-auto scrollbar-hide flex-1">
          {categories.map((cat, index) => (
            <button
              data-category={cat}
              class={`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors ${
                index === 0
                  ? 'bg-primary text-white'
                  : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
              }`}
            >
              {cat}
            </button>
          ))}
        </div>

        <!-- View toggle (mobile only) -->
        <div class="flex md:hidden items-center gap-1 ml-3 bg-gray-100 rounded-lg p-1">
          <button
            id="view-grid"
            class="view-toggle p-2 rounded-md bg-white shadow-sm text-primary"
            aria-label="Grid view"
          >
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"/>
            </svg>
          </button>
          <button
            id="view-list"
            class="view-toggle p-2 rounded-md text-gray-400"
            aria-label="List view"
          >
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- Tours Grid -->
  <section class="py-12 md:py-16 bg-light">
    <div class="container">
      <div id="tours-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">
        {allTours.map(tour => (
          <div data-tour-category={tour.category}>
            <TourCard {...tour} />
          </div>
        ))}
      </div>

      <!-- Empty State -->
      <div id="empty-state" class="hidden text-center py-16">
        <svg class="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <h3 class="text-xl font-semibold text-gray-600 mb-2">No tours found</h3>
        <p class="text-gray-500">Try selecting a different category.</p>
      </div>
    </div>
  </section>

  <!-- Info Section -->
  <section class="py-12 bg-white">
    <div class="container">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
        <div class="p-6">
          <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
            </svg>
          </div>
          <h3 class="font-semibold text-dark mb-2">Free Cancellation</h3>
          <p class="text-gray-600 text-sm">Cancel anytime before the tour for a full refund</p>
        </div>
        <div class="p-6">
          <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
          </div>
          <h3 class="font-semibold text-dark mb-2">Hotel Pickup</h3>
          <p class="text-gray-600 text-sm">Transport included from your hotel</p>
        </div>
        <div class="p-6">
          <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129" />
            </svg>
          </div>
          <h3 class="font-semibold text-dark mb-2">Multilingual Guides</h3>
          <p class="text-gray-600 text-sm">Tours available in English, French, Portuguese & Spanish</p>
        </div>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="py-16 md:py-20 bg-light">
    <div class="container">
      <div class="bg-primary rounded-2xl p-8 md:p-12 text-center">
        <h2 class="font-display font-bold text-2xl md:text-3xl text-white mb-4">
          Can't Find What You're Looking For?
        </h2>
        <p class="text-white/90 mb-8 max-w-2xl mx-auto">
          We offer custom tours tailored to your preferences. Contact us to create your perfect Boa Vista adventure.
        </p>
        <a
          href="/contact"
          class="inline-flex items-center px-8 py-4 bg-white text-primary font-semibold rounded-lg hover:bg-gray-100 transition-colors"
        >
          Request Custom Tour
        </a>
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  /* Grid view (default on mobile) */
  @media (max-width: 767px) {
    #tours-grid.grid-view {
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    #tours-grid.grid-view :global(.tour-card) {
      /* Compact card for grid */
    }

    #tours-grid.grid-view :global(.tour-card p) {
      display: none;
    }

    #tours-grid.grid-view :global(.tour-card h3) {
      font-size: 14px;
      margin-bottom: 8px;
    }

    #tours-grid.grid-view :global(.tour-card .p-5) {
      padding: 12px;
    }

    /* Hide rating in grid view on mobile */
    #tours-grid.grid-view :global(.tour-card .flex.items-center.gap-2.mb-4) {
      display: none;
    }

    /* List view */
    #tours-grid.list-view {
      grid-template-columns: 1fr;
      gap: 16px;
    }
  }
</style>

<script>
  const filterButtons = document.querySelectorAll('[data-category]');
  const tourCards = document.querySelectorAll('[data-tour-category]');
  const emptyState = document.getElementById('empty-state');
  const toursGrid = document.getElementById('tours-grid');
  const viewGridBtn = document.getElementById('view-grid');
  const viewListBtn = document.getElementById('view-list');

  // Category filtering
  filterButtons.forEach(button => {
    button.addEventListener('click', () => {
      const category = button.getAttribute('data-category');

      // Update active button
      filterButtons.forEach(btn => {
        btn.classList.remove('bg-primary', 'text-white');
        btn.classList.add('bg-gray-100', 'text-gray-600');
      });
      button.classList.remove('bg-gray-100', 'text-gray-600');
      button.classList.add('bg-primary', 'text-white');

      // Filter tours
      let visibleCount = 0;
      tourCards.forEach(card => {
        const cardCategory = card.getAttribute('data-tour-category');
        if (category === 'All' || cardCategory === category) {
          (card as HTMLElement).style.display = 'block';
          visibleCount++;
        } else {
          (card as HTMLElement).style.display = 'none';
        }
      });

      // Show/hide empty state
      if (visibleCount === 0) {
        emptyState?.classList.remove('hidden');
      } else {
        emptyState?.classList.add('hidden');
      }
    });
  });

  // View toggle (grid/list)
  function setView(view: 'grid' | 'list') {
    if (!toursGrid) return;

    if (view === 'grid') {
      toursGrid.classList.remove('list-view');
      toursGrid.classList.add('grid-view');
      viewGridBtn?.classList.add('bg-white', 'shadow-sm', 'text-primary');
      viewGridBtn?.classList.remove('text-gray-400');
      viewListBtn?.classList.remove('bg-white', 'shadow-sm', 'text-primary');
      viewListBtn?.classList.add('text-gray-400');
    } else {
      toursGrid.classList.remove('grid-view');
      toursGrid.classList.add('list-view');
      viewListBtn?.classList.add('bg-white', 'shadow-sm', 'text-primary');
      viewListBtn?.classList.remove('text-gray-400');
      viewGridBtn?.classList.remove('bg-white', 'shadow-sm', 'text-primary');
      viewGridBtn?.classList.add('text-gray-400');
    }

    // Save preference
    localStorage.setItem('toursView', view);
  }

  // Load saved preference
  const savedView = localStorage.getItem('toursView') as 'grid' | 'list' | null;
  if (savedView) {
    setView(savedView);
  }

  viewGridBtn?.addEventListener('click', () => setView('grid'));
  viewListBtn?.addEventListener('click', () => setView('list'));
</script>
