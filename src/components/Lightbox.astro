---
// Simple photo lightbox - add class "lightbox-trigger" to any clickable image
---

<div id="lightbox" class="lightbox-overlay">
  <button class="lightbox-close" aria-label="Close lightbox">
    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
    </svg>
  </button>
  <button class="lightbox-nav lightbox-prev" aria-label="Previous image">
    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
    </svg>
  </button>
  <button class="lightbox-nav lightbox-next" aria-label="Next image">
    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
    </svg>
  </button>
  <div class="lightbox-content">
    <img id="lightbox-img" src="" alt="" />
  </div>
  <div class="lightbox-counter">
    <span id="lightbox-current">1</span> / <span id="lightbox-total">1</span>
  </div>
</div>

<style>
  .lightbox-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.95);
    z-index: 10001;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
  }

  .lightbox-overlay.is-open {
    opacity: 1;
    visibility: visible;
  }

  .lightbox-close {
    position: absolute;
    top: 16px;
    right: 16px;
    color: white;
    background: rgba(255, 255, 255, 0.1);
    border: none;
    border-radius: 50%;
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: background 0.2s ease;
    z-index: 10;
  }

  .lightbox-close:hover {
    background: rgba(255, 255, 255, 0.2);
  }

  .lightbox-nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    color: white;
    background: rgba(255, 255, 255, 0.1);
    border: none;
    border-radius: 50%;
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: background 0.2s ease, opacity 0.2s ease;
    z-index: 10;
  }

  .lightbox-nav:hover {
    background: rgba(255, 255, 255, 0.2);
  }

  .lightbox-nav:disabled {
    opacity: 0.3;
    cursor: not-allowed;
  }

  .lightbox-prev {
    left: 16px;
  }

  .lightbox-next {
    right: 16px;
  }

  .lightbox-content {
    max-width: 90vw;
    max-height: 85vh;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .lightbox-content img {
    max-width: 100%;
    max-height: 85vh;
    object-fit: contain;
    border-radius: 8px;
    transform: scale(0.9);
    transition: transform 0.3s ease;
  }

  .lightbox-overlay.is-open .lightbox-content img {
    transform: scale(1);
  }

  .lightbox-counter {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    color: white;
    font-size: 14px;
    background: rgba(0, 0, 0, 0.5);
    padding: 8px 16px;
    border-radius: 20px;
  }

  @media (max-width: 640px) {
    .lightbox-nav {
      width: 40px;
      height: 40px;
    }

    .lightbox-prev {
      left: 8px;
    }

    .lightbox-next {
      right: 8px;
    }
  }
</style>

<script>
  const lightbox = document.getElementById('lightbox');
  const lightboxImg = document.getElementById('lightbox-img') as HTMLImageElement;
  const lightboxClose = document.querySelector('.lightbox-close');
  const lightboxPrev = document.querySelector('.lightbox-prev') as HTMLButtonElement;
  const lightboxNext = document.querySelector('.lightbox-next') as HTMLButtonElement;
  const lightboxCurrent = document.getElementById('lightbox-current');
  const lightboxTotal = document.getElementById('lightbox-total');

  let images: string[] = [];
  let currentIndex = 0;

  // Find all lightbox triggers
  const triggers = document.querySelectorAll('.lightbox-trigger, [data-lightbox]');

  triggers.forEach((trigger, index) => {
    const img = trigger.querySelector('img') || trigger;
    const src = img.getAttribute('src') || img.getAttribute('data-lightbox-src') || '';
    if (src) {
      images.push(src);
      trigger.addEventListener('click', (e) => {
        e.preventDefault();
        openLightbox(index);
      });
      // Add cursor style
      (trigger as HTMLElement).style.cursor = 'zoom-in';
    }
  });

  function openLightbox(index: number) {
    currentIndex = index;
    updateLightbox();
    lightbox?.classList.add('is-open');
    document.body.style.overflow = 'hidden';
  }

  function closeLightbox() {
    lightbox?.classList.remove('is-open');
    document.body.style.overflow = '';
  }

  function updateLightbox() {
    if (lightboxImg) {
      lightboxImg.src = images[currentIndex];
    }
    if (lightboxCurrent) {
      lightboxCurrent.textContent = String(currentIndex + 1);
    }
    if (lightboxTotal) {
      lightboxTotal.textContent = String(images.length);
    }
    if (lightboxPrev) {
      lightboxPrev.disabled = currentIndex === 0;
    }
    if (lightboxNext) {
      lightboxNext.disabled = currentIndex === images.length - 1;
    }
  }

  function prevImage() {
    if (currentIndex > 0) {
      currentIndex--;
      updateLightbox();
    }
  }

  function nextImage() {
    if (currentIndex < images.length - 1) {
      currentIndex++;
      updateLightbox();
    }
  }

  lightboxClose?.addEventListener('click', closeLightbox);
  lightboxPrev?.addEventListener('click', prevImage);
  lightboxNext?.addEventListener('click', nextImage);

  // Close on overlay click
  lightbox?.addEventListener('click', (e) => {
    if (e.target === lightbox) {
      closeLightbox();
    }
  });

  // Keyboard navigation
  document.addEventListener('keydown', (e) => {
    if (!lightbox?.classList.contains('is-open')) return;

    if (e.key === 'Escape') closeLightbox();
    if (e.key === 'ArrowLeft') prevImage();
    if (e.key === 'ArrowRight') nextImage();
  });
</script>
